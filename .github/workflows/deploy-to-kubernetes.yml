name: Deploy to Kubernetes

on:
  push:
    branches:
      - master 
      - kubernetes
    # paths:
    #   - 'k8s/*.yaml'

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
    - name: Check out the code
      uses: actions/checkout@v4
    - name: Start minikube
      uses: medyagh/setup-minikube@latest
    - name: Apply Kubernetes configurations
      run: |
        kubectl apply -f k8s/player-deployment.yaml
        kubectl apply -f k8s/server-deployment.yaml
  deploy-verification:
    runs-on: ubuntu-latest
    steps:
    - name: Verify deployment
      run: |
            kubectl get deployments
            kubectl get pods